    int index = 0;
    while (index < theDataTable.Rows.Count) {
       // start of table row
       for (int column = 0; column < numberOfColumns; i++) {
          if (index < theDataTable.Rows.Count) {
             // table cell with data from theDataTable.Rows[index]
          } else {
             // empty cell
          }
          index++;
       }
       // end of table row
    }
