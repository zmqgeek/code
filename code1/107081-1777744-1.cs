    Imports System.Diagnostics
    Imports System.ServiceModel
    Imports System.IO
    Imports vb = Microsoft.VisualBasic
    
    Module MainAppLoader
    
    Sub Main()
    
    Dim epAddress As EndpointAddress
    Dim Client As picClient
    Dim s As String
    Dim loadFile As String
    Dim procs() As Process
    Dim processName As String = "MainApp"
    
    loadFile = "" ' filename to load
    
    procs = Process.GetProcessesByName(processName)
    
    If UBound(procs) >= 0 Then
      epAddress = New EndpointAddress("net.pipe://localhost/MainAppPicLoad")
      Client = New picClient(New NetNamedPipeBinding, epAddress)
      s = Client.LoadPic(loadFile)
    End If
    
    End Sub
    
    <System.Diagnostics.DebuggerStepThroughAttribute(), _
     System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "3.0.0.0")> _
    Partial Public Class picClient
        Inherits System.ServiceModel.ClientBase(Of IMainAppPicLoad)
        Implements IMainAppPicLoad
    
        Public Sub New(ByVal binding As System.ServiceModel.Channels.Binding, ByVal remoteAddress As System.ServiceModel.EndpointAddress)
            MyBase.New(binding, remoteAddress)
        End Sub
    
        Public Function LoadPic(ByVal fName As String) As String Implements IMainAppPicLoad.LoadPic
            Return MyBase.Channel.LoadPic(fName)
        End Function
    
    End Class
    
    ' from here down was auto generated by svcutil.
    ' svcutil.exe /language:vb /out:generatedProxy.vb /config:app.config http://localhost:8000/MainAppPicLoad
    ' Some has been simplified after auto code generation.
    <System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "3.0.0.0"), _
     System.ServiceModel.ServiceContractAttribute(ConfigurationName:="IMainAppPicLoad")> _
    Public Interface IMainAppPicLoad
      <System.ServiceModel.OperationContractAttribute(Action:="http://tempuri.org/IMainAppPicLoad/LoadPic", ReplyAction:="http://tempuri.org/IMainAppPicLoad/LoadPicResponse")> _
      Function LoadPic(ByVal fName As String) As String
    End Interface
    
    <System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "3.0.0.0")> _
    Public Interface IMainAppPicLoadChannel
      Inherits IMainAppPicLoad, System.ServiceModel.IClientChannel
    End Interface
    
    <System.Diagnostics.DebuggerStepThroughAttribute(), _
    System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "3.0.0.0")> _
    Partial Public Class IMainAppPicLoadClient
      Inherits System.ServiceModel.ClientBase(Of IMainAppPicLoad)
      Implements IMainAppPicLoad
    
      Public Sub New(ByVal binding As System.ServiceModel.Channels.Binding, ByVal remoteAddress As System.ServiceModel.EndpointAddress)
        MyBase.New(binding, remoteAddress)
      End Sub
    
      Public Function LoadPic(ByVal fName As String) As String Implements IMainAppPicLoad.LoadPic
        Return MyBase.Channel.LoadPic(fName)
      End Function
    End Class
    
    End Module
    <ServiceContract()> Public Interface IMainAppPicLoad
    <OperationContract()> Function LoadPic(ByVal fName As String) As String
    End Interface
